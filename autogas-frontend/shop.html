<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <title>AGU Logotip Animatsiyasi (GSAP - Yaxshilangan)</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>

    <!-- Tailwind CDN for utility classes used in the markup -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Local styles (overrides, custom CSS) -->
    <link rel="stylesheet" href="style.css">

    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
        overflow: auto; 
        }

        .logo-container {
            padding: 50px;
            cursor: pointer;
            perspective: 1000px; /* 3D effektlar uchun kerak */
        }

        /* Asosiy logotip uslublari */
        .agu-logo {
            font-family: Arial, sans-serif;
            font-size: 90px; /* Kattaroq qildik */
            font-weight: 800; /* Yanada qalin */
            display: inline-block;
        }

        .agu-logo .red-part { color: #E30613; }
        .agu-logo .blue-part { color: #0B3373; }
        
        /* 1. "Auto Gas Uzbekistan" yozuvini o'zgartirish */
        .subtitle { 
            font-family: 'Helvetica Neue', Arial, sans-serif; /* Shriftni o'zgartirdik */
            font-size: 24px; /* Kattaroq qildik */
            font-weight: 700; /* Qalinroq qildik */
            color: #0B3373;
            margin-top: -15px; /* Logotipga yaqinlashtirdik */
            display: block; 
            white-space: nowrap; /* Matn bir qatorda turishi uchun */
        }
        
        /* Harf elementlari, GSAP ularni alohida boshqaradi */
        .subtitle span {
            display: inline-block; 
            /* Boshlang'ich holati animatsiya orqali boshqariladi */
            transform-origin: center center;
        }
        
        .registered {
             font-size: 40px;
             vertical-align: top;
             line-height: 1;
             color: #0B3373;
             display: inline-block;
        }

    </style>
</head>
<body>
<div id="debug-console" style="position: fixed; top: 0; left: 0; width: 100%; background: rgba(0,0,0,0.8); color: lime; font-family: monospace; z-index: 9999; padding: 10px; font-size: 12px; max-height: 200px; overflow-y: auto;"></div>
<script>
    window.debugLog = function(message) {
        const consoleDiv = document.getElementById('debug-console');
        if (consoleDiv) {
            const entry = document.createElement('div');
            if (typeof message === 'object') {
                entry.textContent = JSON.stringify(message, null, 2);
            } else {
                entry.textContent = message;
            }
            consoleDiv.appendChild(entry);
            consoleDiv.scrollTop = consoleDiv.scrollHeight;
        }
        console.log(message); // Also log to the real console
    };
</script>

<div class="logo-container" id="logoContainer">
    <div class="agu-logo">
        <span class="red-part" id="ag">AG</span><span class="blue-part" id="u">U</span><sup class="registered" id="reg">Â®</sup>
    </div>
    
    <div class="subtitle" id="subtitle-text">
        <span class="s-char">A</span><span class="s-char">u</span><span class="s-char">t</span><span class="s-char">o</span><span class="s-char">&nbsp;</span>
        <span class="s-char">G</span><span class="s-char">a</span><span class="s-char">s</span><span class="s-char">&nbsp;</span>
        <span class="s-char">U</span><span class="s-char">z</span><span class="s-char">b</span><span class="s-char">e</span><span class="s-char">k</span><span class="s-char">i</span><span class="s-char">s</span><span class="s-char">t</span><span class="s-char">a</span><span class="s-char">n</span>
    </div>
</div>

<!-- ARIA live region for screen reader announcements -->
<div id="site-live" class="sr-only" aria-live="polite" aria-atomic="true"></div>

<!-- Minimal products grid so JS modules can render content -->
<section id="products-section" style="width:100%;padding:40px 16px;background:#fff;color:#222;">
    <div style="max-width:1100px;margin:0 auto;">
        <h2 id="products-title" style="font-size:28px;margin-bottom:16px;color:var(--dark-gray);">Mashhur Mahsulotlar</h2>
        <div id="products-grid" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:16px;"></div>
        <div id="pagination-container" style="margin-top:24px;display:flex;gap:8px;justify-content:center;"></div>
    </div>
</section>

<script>
    // Animatsiya qismlari
    const ag = document.getElementById('ag');
    const u = document.getElementById('u');
    const reg = document.getElementById('reg');
    const subtitleChars = document.querySelectorAll('.s-char');

    // 2. Kirish animatsiyasini noodatiy qilish (Harfma-harf va 3D)
    const tl = gsap.timeline({ defaults: { duration: 0.6, ease: "back.out(1.2)" } });

    // AGU uch qismini kiritish (Bir oz 3D effekti bilan)
    tl.from(ag, { 
        x: -50, 
        opacity: 0, 
        rotationY: -90, /* Yon tomondan aylanish */
    })
    .from(u, { 
        x: 50, 
        opacity: 0, 
        rotationY: 90, /* Yon tomondan aylanish */
    }, "<0.1") // Oldingisidan sal keyin boshlash
    .from(reg, {
        y: -100, 
        opacity: 0,
        rotationZ: 360, /* 360 daraja aylanish */
        ease: "power2.out"
    }, "<0.1") 
    
    // Auto Gas Uzbekistan yozuvini harfma-harf kiritish (Staggered effect)
    tl.from(subtitleChars, {
        y: 20, /* Pastdan ko'tarilish */
        opacity: 0,
        scale: 0.5, /* Kichikdan kattaga */
        duration: 0.3,
        ease: "power1.out",
        stagger: 0.03, /* Har bir harfni 0.03 sekund farq bilan animatsiya qilish */
    }, "-=0.3"); // Logotip tugashiga yaqin boshlash

    // Agar sahifa deferProductsUntilLogo bayrog'i o'rnatilgan bo'lsa, animatsiya tugagach mahsulotlarni yuklash
    tl.eventCallback('onComplete', () => {
        if (window.deferProductsUntilLogo && window.productsModule && typeof window.productsModule.renderProducts === 'function') {
            // mahsulotlar regionini asta-sekin ko'rsatish
            const prodSection = document.getElementById('products-section');
            if (prodSection) {
                prodSection.style.opacity = 0;
                window.productsModule.renderProducts().then(() => {
                    gsap.to(prodSection, { opacity: 1, duration: 0.8, ease: 'power2.out' });
                }).catch(e => console.error('renderProducts after logo failed', e));
            } else {
                window.productsModule.renderProducts().catch(e => console.error('renderProducts after logo failed', e));
            }
        }
    });

    // Hover (Sichqoncha ustiga olib kelish) animatsiyasi
    const container = document.getElementById('logoContainer');
    
    container.addEventListener('mouseenter', () => {
        // Asosiy logotip qismlari
        gsap.to(ag, { x: -8, scale: 1.05, color: '#ff3333', duration: 0.3 });
        gsap.to(u, { x: 8, scale: 1.05, duration: 0.3 });
        gsap.to(reg, { y: -5, duration: 0.3 });
        
        // Harflarni biroz "nafas olgan" kabi tebranishi
        gsap.to(subtitleChars, {
            y: -2, /* Yuqoriga siljish */
            scale: 1.02, /* Kichik kattalashish */
            color: '#3b62b7',
            stagger: 0.05, /* Tebranish farqi */
            duration: 0.2,
            overwrite: true /* Oldingi animatsiyani bekor qilish */
        });
    });

    container.addEventListener('mouseleave', () => {
        // Asl holatiga qaytish (elatik effekt bilan)
        gsap.to([ag, u, reg], { 
            x: 0, 
            y: 0, 
            scale: 1, 
            duration: 0.5, 
            ease: "elastic.out(1, 0.5)",
            color: (i, target) => {
                if (target.id === 'ag') return '#E30613';
                if (target.id === 'u' || target.id === 'reg') return '#0B3373';
            },
        });
        
        // Harflarni asl holatiga qaytarish
        gsap.to(subtitleChars, {
            y: 0,
            scale: 1,
            color: '#0B3373',
            stagger: 0.05,
            duration: 0.5,
            ease: "power2.out",
            overwrite: true
        });
    });

</script>
</script>

<!-- Load the ES module entrypoint created during refactor. This attaches new module exports to window
    and allows progressive migration from the legacy script. -->
<script type="module" src="./js/main.js"></script>
</body>
</html>